# [캡스톤디자인 I] 행동 의도 기반 위험 탐지 CCTV 시스템

- **팀 명**: **VoID** **-** **V**ision **o**f **I**nvisible **D**arkness
- **팀 원**: **이왕재(팀장)**, 양범석, 오서진, 원종은
- **지도 교수**: 박동찬 교수님

## ♥ 프로젝트 로드맵 ♥

| 기간 | 목표 | 상태 | 회의록 |
| :--- | :--- | :--- | :---|
| **9월 17일 ~ 9월 24일 (Week3)** | 모델 및 데이터셋 조사, 관련 선행 연구 논문 및 실제 적용 사례 조사 | 🟢 완료 | [Week3_Minutes_1](Week3/Week3_Minutes_1.md)  <br/> [Week3_Minutes_2](Week3/Week3_Minutes_2.md) |
| **9월 25일 ~ 10월 1일 (Week4)** | AI Hub 데이터셋 전처리 작업 - 어노테이션 파일 재건축 | 🟢 완료 | [Week4_Minutes](Week4/Week4_Minutes.md) |
| **10월 2일 ~ 10월 8일 (Week5)** | 어노테이션 파일 재건축 지속 및 추가 카테고리 할당, 모델 설계 사전 조사 | 🟡 진행 중 | 
| **10월 9일 ~ 10월 15일 (Week6)** | 추가 예정 | ⚫️ 대기 |
| **10월 16일 ~ 10월 22일 (Week7)** | 추가 예정 | ⚫️ 대기 |


## ♥ 업무 분담 ♥
### *[9월 17일 ~ 9월 24일 (Week3)](./Week3/)*

- [**원종은 & 양범석**](Week3/Research_양범석_원종은.md): 
  - 행동 의도 탐지에 적합한 딥러닝 모델 아키텍처 조사 (공통)
  - 활용 가능한 공개 데이터셋 목록 정리 및 특성 분석

- [**이왕재 & 오서진**](Week3/Research_이왕재_오서진.md): 
  - 행동 의도 탐지에 적합한 딥러닝 모델 아키텍처 조사 (공통)
  - 관련 선행 연구 논문 및 실제 적용 사례 조사
  
---

### *[9월 25일 ~ 10월 1일 (Week4)](./Week4/)*

- **이왕재**: 절도(Burglary) 350편 + @
- **양범석**: 폭행(Assualt) 350편 + @
- **오서진**: 싸움(Fight) 350편 + @
- **원종은**: 실신(Swoon) 350편 + @
- 영상 클리핑은 **할 필요 없습니다**, <br/> 원본 어노테이션 파일 구조 변경 후 제목 변경(XML -> JSON, "plus_ + {원본 어노테이션 파일 명}"
- **[convert.py](Week4/convert.py)** 참고하시고, **디렉토리 구조도 원본과 동일하게 작업해주시면 됩니다.**
- 의심(suspicious)구간을 비정상 구간에 포함시키면 안 됩니다. 무조건 비정상 event 시작 전으로 해주셔야 합니다!

---

### *[10월 2일 ~ 10월 8일 (Week5)](./Week5/)*

- **10월 14일까지** 각자 진행 중인 카테고리 **어노테이션 파일 완성** 및 **모델 설계 사전 조사**
- **추가적 카테고리 할당** (전반적으로 계속 진행 예정) 
    - **이왕재**: 데이트 폭력 및 추행(Datefight) 
    - **양범석**: 강도(Robbery)
    - **오서진**: 투기(Dump)
    - **원종은**: 납치(Kidnap)

- **모델 설계 사전 조사**
  - **이왕재**: 전체적인 모델 파이프라인 설계 (`데이터셋` → `Pose` 모델 → `Sequence` 모델)
  - **양범석**: 모델에 데이터를 어떤 방식으로 `Input` 할지 조사 (Data Feeding)
  - **오서진**: **Sequence 모델** 조사
    - 스켈레톤과 영상의 문맥을 파악하여 정상, 의심, 비정상 구간을 판단하는 모델
  - **원종은**: **Pose 모델** 조사
    - 스켈레톤 추출에 필요한 `Input` 데이터의 형태
    - `Input` 대비 `Output` 데이터의 형태 (예: 스켈레톤 좌표만, 영상과 함께 등)
    - 스켈레톤 추출에 필요한 기본 정보
 
- **전체 모델 아키텍쳐**: `Input Frame` → `Pose` (스켈레톤 검출) → `Sequence` 모델로 추론
- 
## ♥ 회의 일정 ♥

- **매주 목요일 13:00 ~ 14:00**
  - 장소: 공학1관 6층 633호 세미나실
  - 형식: 대면 회의 및 교수님 앞 발표
  - 발표 자료: PPT, PDF 등

- **특이사항**
  - **9월 25일 (Week3)**: 교수님 출장으로 목요일 오전까지 이메일로 제출
  - 이후 평소 일정대로 세미나실에서 대면 발표 진행

## ♥ 프로젝트 개요 ♥

본 프로젝트는 고정형 CCTV 영상을 실시간 분석하여 인간의 **행동 의도**와 **전조 행동**을 감지함으로써 범죄 발생 전의 **의심 행동**을 조기에 탐지하고 경고하는 지능형 보안 시스템을 개발하는 것을 목표로 한다. 

**포즈 기반 행동 분석**을 통해 영상 저장 없이 **스켈레톤 정보**만 활용함으로써 **프라이버시**를 보장하며, 공공 및 민간 보안 환경에 적용 가능성을 확보한다. 최종 목표는 CCTV 영상을 실시간으로 탐지한 결과를 **웹사이트에 시각화하여 스트리밍**하는 것까지 구현하는 것이다. 

**해당 Github Repository**를 통해 매주 조사 내용, 코드 개발 현황, 실험 결과를 공유하며, 팀원 간 협업과 피드백을 원활하게 진행할 예정이다.

## ♥ 주요 구성 요소 ♥

1. **데이터 수집 및 구축**
   - **AI Hub 이상행동 CCTV 영상**: 717시간 분량 (약 4.85 TB), 12개 이상행동 라벨
   - **자체 촬영 영상**: 의심 행동(배회, 접근, 응시) 재연 및 라벨링
   - **추가 데이터 조사 예정**: UCF-Crime, XD-Violence, ShanghaiTech Anomaly 외 공개 데이터셋 목록 업데이트

2. **데이터 전처리 및 어노테이션 예시 [(CRxK-6 Github 참조)](https://github.com/dxlabskku/CRxK-6)**
 - `frame_crop.py`: 원본 영상에서 매 3프레임마다 프레임 추출
- **`pose_estimation.py`**: 추출된 프레임에서 **OpenPose** 또는 **MediaPipe**와 같은 포즈 추정 모델을 사용하여 **인체의 주요 관절(Keypoints) 좌표인 스켈레톤 데이터를 추출**, 이 과정을 통해 원본 이미지는 폐기하고 비식별화된 스켈레톤 정보만 저장하여 프라이버시를 보호한다.
- `make_annotation.py`: 추출된 스켈레톤 데이터 시퀀스에 행동 라벨을 매칭하여 모델 학습용 데이터셋을 최종 구축.

3.  **모델 학습**
    - **입력 데이터**: 시퀀스 형태의 **2D/3D 스켈레톤 좌표 정보**
    - **1단계 이진 분류**: 위험(의심 포함) vs 정상. **스켈레톤 데이터의 시공간적 특징을 학습**하기 위해 **ST-GCN(Spatial Temporal Graph Convolutional Network)** 또는 **LSTM 기반 모델**을 검토.
    - **2단계 다중 분류**: 세부 행동 유형(Assault, Robbery, Hover 등) 분류.
    - **성능 최적화**: 데이터 증강(회전, 노이즈 추가 등), ONNX/TensorRT 변환.
    - **실행 환경**: 엘리스 GPU 서버(Elice) 사용

4. **실시간 추론**
   - RTSP 스트림 연결 → 프레임 캡처 → 전처리 → 모델 예측
   - 연속 3프레임 이상 위험 행동 감지 시 모바일, 웹, SMS 경고 발신
   - **카메라**: HIKVISION DS-2CD2043G2-I CCTV 카메라 2대

5. **확장성 및 추가 데이터셋**
   - **공개 데이터셋**: UCF-Crime, XD-Violence, ShanghaiTech Anomaly, VIRAT, Avenue
   - **추가 조사 예정**: 도로 교통 이상행동, 상업시설 보안 데이터 등 신규 데이터셋 검토
   - **프라이버시 보호**: 스켈레톤 기반 처리로 원본 영상 미저장

## ♥ 기대 효과 ♥
- **사전 예방적 대응**: 범죄 발생 전 의심 단계에서 알람 제공
- **운영 비용 절감**: 영상 미저장 및 엘리스 GPU 서버 활용
- **다양한 적용 분야**: 스마트시티, 공공시설, 교통 허브, 학교 보안
